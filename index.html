<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sunrise and Born Time</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <a id="reset" href="" class="btn float-end" ><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"/>
      <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"/>
    </svg></a>
    <div class="container py-5">
      <div class="card shadow">
        <div style="background-color: #fae3dc" class="card-header text-center">
          <h4 style="background-color: #fae3dc" class="m-0" id="title">
            SURIYA UDHAYA NAZHIGAI
          </h4>
        </div>
        <div class="card-body">
          <form id="time-form">
            <div class="mb-3">
              <label class="form-label">Tamil Month</label>
              <div class="d-flex">
                <select
                  id="tamil-month"
                  class="form-control"
                  placeholder="Month"
                >
                  <option value="chithirai">சித்திரை</option>
                  <option value="vaikasi">வைகாசி</option>
                  <option value="aani">ஆனி</option>
                  <option value="aadi">ஆடி</option>
                  <option value="aavani">ஆவணி</option>
                  <option value="purattasi">புரட்டாசி</option>
                  <option value="aippasi">ஐப்பசி</option>
                  <option value="karthigai">கார்த்திகை</option>
                  <option value="margazhi">மார்கழி</option>
                  <option value="thai">தை</option>
                  <option value="maasi">மாசி</option>
                  <option value="panguni">பங்குனி</option>
                </select>
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label">Date</label>
              <div class="d-flex align-items-center">
                <select
                  id="tamil-date"
                  class="form-control me-2"
                  placeholder="date"
                >
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                  <option value="13">13</option>
                  <option value="14">14</option>
                  <option value="15">15</option>
                  <option value="16">16</option>
                  <option value="17">17</option>
                  <option value="18">18</option>
                  <option value="19">19</option>
                  <option value="20">20</option>
                  <option value="21">21</option>
                  <option value="22">22</option>
                  <option value="23">23</option>
                  <option value="24">24</option>
                  <option value="25">25</option>
                  <option value="26">26</option>
                  <option value="27">27</option>
                  <option value="28">28</option>
                  <option value="29">29</option>
                  <option value="30">30</option>
                  <option value="31">31</option>
                  <option value="32">32</option>
                  <option value="33">33</option>
                </select>
              </div>
            </div>

            <!-- Sunrise Time -->
            <div class="mb-3">
              <label class="form-label">Sunrise Time</label>
              <div class="d-flex">
                <select id="sunrise-hour" class="form-select me-2">
                  <option value="5">5</option>
                  <option value="6">6</option>
                </select>
                <select
                  id="sunrise-minute"
                  class="form-control"
                  placeholder="Minute"
                >
                  <option value="0">0</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                  <option value="13">13</option>
                  <option value="14">14</option>
                  <option value="15">15</option>
                  <option value="16">16</option>
                  <option value="17">17</option>
                  <option value="18">18</option>
                  <option value="19">19</option>
                  <option value="20">20</option>
                  <option value="21">21</option>
                  <option value="22">22</option>
                  <option value="23">23</option>
                  <option value="24">24</option>
                  <option value="25">25</option>
                  <option value="26">26</option>
                  <option value="27">27</option>
                  <option value="28">28</option>
                  <option value="29">29</option>
                  <option value="30">30</option>
                  <option value="31">31</option>
                  <option value="32">32</option>
                  <option value="33">33</option>
                  <option value="34">34</option>
                  <option value="35">35</option>
                  <option value="36">36</option>
                  <option value="37">37</option>
                  <option value="38">38</option>
                  <option value="39">39</option>
                  <option value="40">40</option>
                  <option value="41">41</option>
                  <option value="42">42</option>
                  <option value="43">43</option>
                  <option value="44">44</option>
                  <option value="45">45</option>
                  <option value="46">46</option>
                  <option value="47">47</option>
                  <option value="48">48</option>
                  <option value="49">49</option>
                  <option value="50">50</option>
                  <option value="51">51</option>
                  <option value="52">52</option>
                  <option value="53">53</option>
                  <option value="54">54</option>
                  <option value="55">55</option>
                  <option value="56">56</option>
                  <option value="57">57</option>
                  <option value="58">58</option>
                  <option value="59">59</option>
                </select>
              </div>
            </div>

            <!-- Born Time -->
            <div class="mb-3">
              <label class="form-label">Born Time</label>
              <div class="d-flex align-items-center">
                <select
                  id="born-hour"
                  class="form-control me-2"
                  placeholder="Hour"
                >
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                </select>

                <select
                  id="born-minute"
                  class="form-control me-2"
                  placeholder="Minute"
                >
                  <option value="0">0</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="4">4</option>
                  <option value="5">5</option>
                  <option value="6">6</option>
                  <option value="7">7</option>
                  <option value="8">8</option>
                  <option value="9">9</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                  <option value="13">13</option>
                  <option value="14">14</option>
                  <option value="15">15</option>
                  <option value="16">16</option>
                  <option value="17">17</option>
                  <option value="18">18</option>
                  <option value="19">19</option>
                  <option value="20">20</option>
                  <option value="21">21</option>
                  <option value="22">22</option>
                  <option value="23">23</option>
                  <option value="24">24</option>
                  <option value="25">25</option>
                  <option value="26">26</option>
                  <option value="27">27</option>
                  <option value="28">28</option>
                  <option value="29">29</option>
                  <option value="30">30</option>
                  <option value="31">31</option>
                  <option value="32">32</option>
                  <option value="33">33</option>
                  <option value="34">34</option>
                  <option value="35">35</option>
                  <option value="36">36</option>
                  <option value="37">37</option>
                  <option value="38">38</option>
                  <option value="39">39</option>
                  <option value="40">40</option>
                  <option value="41">41</option>
                  <option value="42">42</option>
                  <option value="43">43</option>
                  <option value="44">44</option>
                  <option value="45">45</option>
                  <option value="46">46</option>
                  <option value="47">47</option>
                  <option value="48">48</option>
                  <option value="49">49</option>
                  <option value="50">50</option>
                  <option value="51">51</option>
                  <option value="52">52</option>
                  <option value="53">53</option>
                  <option value="54">54</option>
                  <option value="55">55</option>
                  <option value="56">56</option>
                  <option value="57">57</option>
                  <option value="58">58</option>
                  <option value="59">59</option>
                </select>
                <select id="born-ampm" class="form-select">
                  <option value="AM">AM</option>
                  <option value="PM">PM</option>
                </select>
              </div>
            </div>

            <div class="text-center">
              <button type="button" id="process-time" class="btn btn-primary">
                find
              </button>
              <button type="button" onclick="calculateAndRedirect()" class="btn btn-primary">
                <b>லக்னம் </b>  
              </button>
            </div>
          </form>

          <div class="mt-4">
            <div class="border p-3 bg-light" id="result-box">
              <h5>Results</h5>
              <p id="result-text" class="text-muted">
                Click "Process Times" above ⬆️
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      let result=0;
      function getDecimalAsInt(number) {
        const decimalPart = number % 1; // Get the decimal part
        return Math.round(decimalPart * 100); // Convert it to minutes (e.g., 0.15 -> 15)
      }

      function nalAdd(x,y)
{
    x = nalToVinal(x);
    y = nalToVinal(y);
    let z = VinalToNal(x+y)
    return z;
}

      function calculateAndRedirect()
      {
          if(result==0)
          {
            window.alert("click find first")
          }
          else
          {
            if(result.tharparai>=30)
              result.vinazhigai+=1;
            let encodedValue = ((result.nazhigai) + ((result.vinazhigai)/100))
            const targetUrl = `https://rvkarthi.github.io/janana-nazhigai/?value=${encodedValue}`;
            // Redirect to the target page
            window.location.href = targetUrl;
            
          }
      }

      // Function to calculate Nazhigai, Vinazhigai, and Tharparai
      function timeToNazhigai(hours, minutes, seconds) {
        const totalSeconds = hours * 3600 + minutes * 60 + seconds;
        const nazhigai = totalSeconds / 1440; // 1 Nazhigai = 1440 seconds
        const vinazhigai = (nazhigai - Math.floor(nazhigai)) * 60;
        const tharparai = (vinazhigai - Math.floor(vinazhigai)) * 60;

        return {
          nazhigai: Math.floor(nazhigai),
          vinazhigai: Math.floor(vinazhigai),
          tharparai: Math.round(tharparai),
        };
      }

      // Event listener for processing time
      document.getElementById("process-time").addEventListener("click", () => {
        const tamilmonth = document.getElementById("tamil-month").value;
        const tamildate = parseInt(document.getElementById("tamil-date").value);

        if (!dateValues[tamilmonth] || !dateValues[tamilmonth][tamildate]) {
          document.getElementById("result-text").textContent =
            "Invalid Tamil month or date!";
          return;
        }

        // Extract sunrise time
        const suriyahour = dateValues[tamilmonth][tamildate];
        const sunriseHour = Math.floor(suriyahour); // Extract the hour
        const sunriseMinute = getDecimalAsInt(suriyahour); // Extract the minute

        document.getElementById("sunrise-hour").value = sunriseHour;
        document.getElementById("sunrise-minute").value = sunriseMinute;

        const bornHour = parseInt(document.getElementById("born-hour").value);
        const bornMinute = parseInt(
          document.getElementById("born-minute").value
        );
        const bornAmPm = document.getElementById("born-ampm").value;

        if (
          isNaN(bornHour) ||
          isNaN(bornMinute) ||
          isNaN(sunriseHour) ||
          isNaN(sunriseMinute)
        ) {
          document.getElementById("result-text").textContent =
            "Please enter valid Sunrise and Born time values!";
          return;
        }

        // Adjust `bornHour` for AM/PM
        let adjustedBornHour = bornHour;
        if (bornHour === 12 && bornAmPm === "AM") adjustedBornHour = 0;
        if (bornHour < 12 && bornAmPm === "PM") adjustedBornHour += 12;

        // Calculate the time difference
        let diffHour = adjustedBornHour - sunriseHour;
        let diffMinute = bornMinute - sunriseMinute;

        // Handle negative minutes
        if (diffMinute < 0) {
          diffMinute += 60;
          diffHour -= 1;
        }

        // Handle negative hours (crossing midnight)
        if (diffHour < 0) {
          diffHour += 24;
        }

        // Convert to Nazhigai, Vinazhigai, and Tharparai
        result = timeToNazhigai(diffHour, diffMinute, 0);

        // Display the results
        document.getElementById("result-text").innerHTML = `
        <h4>Nazhigai: ${result.nazhigai}<br>
        Vinazhigai: ${result.vinazhigai}<br>
        Tharparai: ${result.tharparai}</h4>
    `;
      });
    </script>

    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <p class="text-center">created by @Karthikrishna</p>
  </body>
</html>
